## 3.6 ìŠ¤í”„ë§ì˜ JdbcTemplate
ì´ë²ˆì—ëŠ” ìŠ¤í”„ë§ì´ ì œê³µí•˜ëŠ” í…œí”Œë¦¿/ì½œë°± ê¸°ìˆ ì„ ì‚´í´ë³´ì. <br/>
ìŠ¤í”„ë§ì€ JDBCë¥¼ ì´ìš©í•˜ëŠ” DAOì—ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡ ì¤€ë¹„ëœ ë‹¤ì–‘í•œ í…œí”Œë¦¿ê³¼ ì½œë°±ì„ ì œê³µí•œë‹¤.

<br/>

ğŸ”½ JdbcTemplateì˜ ì´ˆê¸°í™”ë¥¼ ìœ„í•œ ì½”ë“œ
```java
public class UserDao {
  ...
  private JdbcTemplate jdbcTemplate;

  public void setDataSource(DataSource dataSource) {
    this.jdbcTemplate = new JdbcTemplate(dataSource);

    this.dataSource = dataSource;
  }
}
```
- ìŠ¤í”„ë§ì´ ì œê³µí•˜ëŠ” JDBC ì½”ë“œìš© ê¸°ë³¸ í…œí”Œë¦¿ì€ JdbcTemplateì´ë‹¤.
- JdbcContext ëŒ€ì‹  ì‚¬ìš©í•´ë³´ì.
- JdbcTemplateì€ ìƒì„±ìì˜ íŒŒë¼ë¯¸í„°ë¡œ DataSourceë¥¼ ì£¼ì…í•˜ë©´ ëœë‹¤.

<br/>

### 3.6.1 update()

ğŸ”½ JdbcTemplateì„ ì ìš©í•œ deleteAll() ë©”ì†Œë“œ
```java
public void deleteAll() {
  this.jdbcTemplate.update(
    new PreparedStatementCreator() {
      public PreparedStatement createPreparedStatement(Connection con) throws SQLException {
        return con.prepareStatement("delete from users");
      }
    }
  );
}
```
- deleteAll()ì— ë¨¼ì € ì ìš©í•´ë³´ì.
- ì½œë°±: StatementStrategy ì¸í„°í˜ì´ìŠ¤ì˜ makePreparedStatement() ë©”ì†Œë“œ > **PreparedStatement ì¸í„°í˜ì´ìŠ¤**ì˜ **createPreparedStatement() ë©”ì†Œë“œ**
- PreparedStatementCreator íƒ€ì…ì˜ ì½œë°±ì„ ë°›ì•„ì„œ ì‚¬ìš©í•˜ëŠ” JdbcTemplateì˜ í…œí”Œë¦¿ ë©”ì†Œë“œëŠ” **update()** ì´ë‹¤.

<br/>

ğŸ”½ ë‚´ì¥ ì½œë°±ì„ ì‚¬ìš©í•˜ëŠ” update()ë¡œ ë³€ê²½í•œ deleteAll() ë©”ì†Œë“œ
```java
public void deleteAll() {
  this.jdbcTemplate.update("delete from users");
}
```
- ì½œë°±ì„ ë°›ëŠ” update() ë©”ì†Œë“œì™€ ì´ë¦„ì€ ë™ì¼í•˜ì§€ë§Œ, **íŒŒë¼ë¯¸í„°ë¡œ SQL ë¬¸ì¥ì„ ì „ë‹¬**í•˜ëŠ” ê²ƒì´ ë‹¤ë¥´ë‹¤.

<br/>

ğŸ”½ add() ë©”ì†Œë“œì˜ ì½œë°± ë‚´ë¶€
```java
PreparedStatement ps = c.prepareStatement("insert into users(id, name, password) values (?,?,?)");
ps.setString(1, user.getId());
ps.setString(2, user.getName());
ps.setString(3, user.getPassword());
```
- í˜„ì¬ add() ë©”ì†Œë“œì—ì„œ ë§Œë“œëŠ” ì½œë°±ì€ PreparedStatementë¥¼ ë§Œë“œëŠ” ê²ƒê³¼ íŒŒë¼ë¯¸í„°ë¥¼ ë°”ì¸ë”©í•˜ëŠ” 2ê°€ì§€ ì‘ì—…ì„ ìˆ˜í–‰í•œë‹¤.

<br/>

```java
this.jdbcTemplate.update("insert into users(id, name, password) values(?,?,?)", user.getId(), user.getName(), user.getPassword());
```
- ì¹˜í™˜ìë¥¼ ê°€ì§„ SQLë¡œ **PreparedStatementë¥¼ ë§Œë“¤ê³ ** í•¨ê»˜ ì œê³µí•˜ëŠ” **íŒŒë¼ë¯¸í„°ë¥¼ ìˆœì„œëŒ€ë¡œ ë°”ì¸ë”©í•´ì£¼ëŠ” ê¸°ëŠ¥**ì„ ê°€ì§„ update() ë©”ì†Œë“œë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.
- SQLê³¼ í•¨ê»˜ ê°€ë³€ì¸ìë¡œ ì„ ì–¸ëœ íŒŒë¼ë¯¸í„°ë¥¼ ì œê³µí•´ì£¼ë©´ ëœë‹¤.

<br/>

### 3.6.2 queryForInt()
ì•„ì§ í…œí”Œë¦¿/ì½œë°± ë°©ì‹ì„ ì ìš©í•˜ì§€ ì•Šì•˜ë˜ ë©”ì†Œë“œì— JdbcTemplateì„ ì ìš©í•´ë³´ì.

<br/>

ğŸ”½ JdbcTemplateì„ ì´ìš©í•´ ë§Œë“  getCount()
```java
public int getCount() {
  return this.jdbcTemplate.query(new PreparedStatementCreator() { // ì²«ë²ˆì§¸ ì½œë°±, Statement ìƒì„±
    public PreparedStatement createPreparedStatement(Connection con) throws SQLException {
      return con.prepareStatement("select count(*) from users");
    }
  }, new ResultSetExtractor<Integer>() { // ë‘ë²ˆì§¸ ì½œë°±, ResultSetìœ¼ë¡œë¶€í„° ê°’ ì¶”ì¶œ
    public Integer extractData(ResultSet rs) throws SQLException, DataAccessException {
      rs.next();
      return rs.getInt(1);
    }
  }
}
```
- getCount()ëŠ” SQL ì¿¼ë¦¬ë¥¼ ì‹¤í–‰í•˜ê³  ResultSetì„ í†µí•´ ê²°ê³¼ ê°’ì„ ê°€ì ¸ì˜¤ëŠ” ì½”ë“œë‹¤.
- ì´ ì‘ì—… íë¦„ì„ ê°€ì§„ ì½”ë“œì—ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” í…œí”Œë¦¿ì€ **PreparedStatementCreator ì½œë°±ê³¼ ResultSetExtractor ì½œë°±ì„ íŒŒë¼ë¯¸í„°ë¡œ ë°›ëŠ” query() ë©”ì†Œë“œ**ì´ë‹¤.
- ì²«ë²ˆì§¸ PreparedStatementCreator ì½œë°±ì€ í…œí”Œë¦¿ìœ¼ë¡œë¶€í„° Connectionì„ ë°›ê³  PreparedStatementë¥¼ ëŒë ¤ì¤€ë‹¤.
- ë‘ë²ˆì§¸ ResultSetExtractorëŠ” í…œí”Œë¦¿ìœ¼ë¡œë¶€í„° ResultSetì„ ë°›ê³  ì¶”ì¶œí•œ ê²°ê³¼ë¥¼ ëŒë ¤ì¤€ë‹¤.
- í•´ë‹¹ ì½”ë“œì˜ ì½œë°± ì˜¤ë¸Œì íŠ¸ ì½”ë“œëŠ” ì¬ì‚¬ìš©í•˜ê¸° ì¢‹ì€ êµ¬ì¡°ë‹¤.

<br/>

ğŸ”½ queryForInt()ë¥¼ ì‚¬ìš©í•˜ë„ë¡ ìˆ˜ì •í•œ getCount()
```java
public int getCount() {
  return this.jdbcTemplate.queryForInt("select count(*) from users");
}
```
- ìœ„ì˜ ê¸°ëŠ¥ì„ ê°€ì§„ ì½œë°±ì„ ë‚´ì¥í•˜ê³  ìˆëŠ” queryForInt()ë¼ëŠ” í¸ë¦¬í•œ ë©”ì†Œë“œë„ ì œê³µí•œë‹¤.
- Integer íƒ€ì…ì˜ ê²°ê³¼ë¥¼ ê°€ì ¸ì˜¬ ìˆ˜ ìˆëŠ” SQL ë¬¸ì¥ë§Œ ì „ë‹¬í•´ì£¼ë©´ ëœë‹¤.
- JdbcTemplateì€ ìŠ¤í”„ë§ì´ ì œê³µí•˜ëŠ” í´ë˜ìŠ¤ì´ì§€ë§Œ DI ì»¨í…Œì´ë„ˆë¥¼ êµ³ì´ í•„ìš”ë¡œ í•˜ì§€ ì•ŠëŠ”ë‹¤. ì§ì ‘ ì˜¤ë¸Œì íŠ¸ë¥¼ ìƒì„±í•˜ê³  ììœ ë¡­ê²Œ ì‚¬ìš©í•˜ë©´ ëœë‹¤.

<br/>

### 3.6.3 queryForObject()
get() ë©”ì†Œë“œì— JdbcTemplateì„ ì ìš©í•´ë³´ì.

<br/>

ğŸ”½ queryForObject()ì™€ RowMapperë¥¼ ì ìš©í•œ get() ë©”ì†Œë“œ
```java
public User get(String id) {
  return this.jdbcTemplate.queryForObject("select * from users where id = ?",
                                          new Object[] {id}, // SQLì— ë°”ì¸ë”©í•  íŒŒë¼ë¯¸í„° ê°’. ê°€ë³€ì¸ì ëŒ€ì‹  ë°°ì—´ì„ ì‚¬ìš©í•œë‹¤.
                                          new RowMapper<User>() { // ResultSetí•œ ë¡œìš°ì˜ ê²°ê³¼ë¥¼ ì˜¤ë¸Œì íŠ¸ì— ë§¤í•‘í•´ì£¼ëŠ” RowMapper ì½œë°±
                                            public User mapRow(ResultSet rs, int rowNum) throws SQLException {
                                              User user = new User();
                                              user.setId(rs.getString("id"));
                                              user.setName(rs.getString("name"));
                                              user.setPassword(rs.getString("password"));
                                              return user;
                                            }
                                          });
}
```
- ì²« ë²ˆì§¸ íŒŒë¼ë¯¸í„°ëŠ” PreparedStatementë¥¼ ë§Œë“¤ê¸° ìœ„í•œ SQLì´ê³ , ë‘ ë²ˆì§¸ëŠ” ì—¬ê¸°ì— ë°”ì¸ë”© í•  ê°’ë“¤ì´ë‹¤.
- ë’¤ì— ë‹¤ë¥¸ íŒŒë¼ë¯¸í„°ê°€ ìˆê¸° ë•Œë¬¸ì—, ê°€ë³€ì¸ì ëŒ€ì‹  Object íƒ€ì… ë°°ì—´ì„ ì‚¬ìš©í•´ì•¼ í•œë‹¤.
- queryForObject() ë‚´ë¶€ì—ì„œ ì´ ë‘ ê°€ì§€ íŒŒë¼ë¯¸í„°ë¥¼ ì‚¬ìš©í•˜ëŠ” PreparedStatement ì½œë°±ì´ ë§Œë“¤ì–´ì§ˆ ê²ƒì´ë‹¤.
- RowMapperì—ì„œëŠ” í˜„ì¬ ResultSetì´ ê°€ë¦¬í‚¤ê³  ìˆëŠ” ë¡œìš°ì˜ ë‚´ìš©ì„ User ì˜¤ë¸Œì íŠ¸ì— ë‹´ì•„ì„œ ë¦¬í„´í•´ì¤€ë‹¤.
- queryForObject()ëŠ” SQLì„ ì‹¤í–‰í•´ì„œ ë¡œìš°ì˜ ê°œìˆ˜ê°€ í•˜ë‚˜ê°€ ì•„ë‹ˆë¼ë©´ EmptyResultDataAccessException ì˜ˆì™¸ë¥¼ ë˜ì§„ë‹¤.

<br/>

### 3.6.4 query()
> ***ê¸°ëŠ¥ ì •ì˜ì™€ í…ŒìŠ¤íŠ¸ ì‘ì„±***

- ëª¨ë“  ì‚¬ìš©ì ì •ë³´ë¥¼ ê°€ì ¸ì˜¤ëŠ” getAll() ë©”ì†Œë“œë¥¼ ì¶”ê°€í•œë‹¤.
- get() ë©”ì†Œë“œëŠ” í•˜ë‚˜ì˜ ë¡œìš°ë¥¼ User ì˜¤ë¸Œì íŠ¸ì— ë‹´ì•˜ìœ¼ë‹ˆ ì—¬ëŸ¬ ê°œë¼ë©´ **User ì˜¤ë¸Œì íŠ¸ì˜ ì»¬ë ‰ì…˜**ìœ¼ë¡œ ë§Œë“ ë‹¤.
- ê¸°ë³¸í‚¤ì¸ id ìˆœìœ¼ë¡œ ì •ë ¬í•´ì„œ ê°€ì ¸ì˜¤ë„ë¡ ë§Œë“ ë‹¤.

<br/>

ğŸ”½ getAll()ì— ëŒ€í•œ í…ŒìŠ¤íŠ¸
```java
@Test
public void getAll() {
  dao.deleteAll();

  dao.add(user1); // Id: 1
  List<User> users1 = dao.getAll();
  assertThat(users1.size(), is(1));
  checkSameUser(user1, users1.get(0));

  dao.add(user2); // Id: 3
  List<User> users2 = dao.getAll();
  assertThat(users2.size(), is(2));
  checkSameUser(user1, users2.get(0));
  checkSameUser(user2, users2.get(1));

  dao.add(user3); // Id: 2
  List<User> users3 = dao.getAll();
  assertThat(users3.size(), is(3));
  checkSameUser(user1, users3.get(0));
  checkSameUser(user3, users3.get(1)); // user3ì˜ id ê°’ì´ ì•ŒíŒŒë²³ìˆœìœ¼ë¡œ user2ì˜ id ê°’ë³´ë‹¤ ë¹ ë¥´ê³ , user1ì˜ id ê°’ë³´ë‹¤ ëŠë¦¬ë¯€ë¡œ getAll()ì˜ ë‘ë²ˆì§¸ ì—˜ë¦¬ë¨¼íŠ¸ì—¬ì•¼ í•œë‹¤.
  checkSameUser(user2, users3.get(2));
}

private void checkSameUser(User user1, User user2) { // User ì˜¤ë¸Œì íŠ¸ì˜ ë‚´ìš©ì„ ë¹„êµí•˜ëŠ” ê²€ì¦ ì½”ë“œ. í…ŒìŠ¤íŠ¸ì—ì„œ ë°˜ë³µì ìœ¼ë¡œ ì‚¬ìš©ë˜ë¯€ë¡œ ë¶„ë¦¬í–ˆë‹¤.
  assertThat(user1.getId(), is(user2.getId()));
  assertThat(user2.getName(), is(user2.getName()));
  assertThat(user3.getPassword(), is(user2.getPassword()));
}
```
- í”½ìŠ¤ì²˜ë¡œ ì¤€ë¹„í•´ë‘” user1, user2, user3ë¥¼ ì°¨ë¡€ë¡œ ì¶”ê°€í•˜ë©´ì„œ getAll()ì´ ëŒë ¤ì£¼ëŠ” ë¦¬ìŠ¤íŠ¸ì˜ í¬ê¸°ì™€ ë¦¬ìŠ¤íŠ¸ì— ë‹´ê¸´ User ì˜¤ë¸Œì íŠ¸ì˜ ë‚´ìš©ì„ í”½ìŠ¤ì²˜ì™€ ë¹„êµ
- Id ìˆœì„œëŒ€ë¡œ ì •ë ¬ëœë‹¤ëŠ” ì ì„ ì£¼ì˜í•˜ì.
- Userì˜ ê°’ì„ ë¹„êµí•˜ëŠ” ì½”ë“œê°€ ë°˜ë³µë˜ê¸° ë•Œë¬¸ì— ë³„ë„ì˜ ë©”ì†Œë“œë¡œ ë¶„ë¦¬í•œë‹¤.
- ì—¬ëŸ¬ í…ŒìŠ¤íŠ¸ í´ë˜ìŠ¤ì— ê±¸ì³ ì¬ì‚¬ìš©ë˜ëŠ” ì½”ë“œë¼ë©´ ë³„ë„ì˜ í´ë˜ìŠ¤ë¡œ ë¶„ë¦¬í•˜ëŠ” ê²ƒë„ ê³ ë ¤í•´ë³¼ ìˆ˜ ìˆë‹¤.

<br/>

> ***query() í…œí”Œë¦¿ì„ ì´ìš©í•˜ëŠ” getAll() êµ¬í˜„***

ğŸ”½ getAll() ë©”ì†Œë“œ
```java
public List<User> getAll() {
  return this.jdbcTemplate.query("select * from users order by id",
                                  new RowMapper<User>() {
                                    public User mapRow(ResultSet rs, int rowNum) throws SQLException {
                                      User user = new User();
                                      user.setId(rs.getString("id"));
                                      user.setName(rs.getSting("name"));
                                      user.getPassword(rs.getString("password"));
                                      return ueser;
                                    }
                                  });
}
```
- ì²«ë²ˆì§¸ íŒŒë¼ë¯¸í„°ì—ëŠ” ì‹¤í–‰í•  SQL ì¿¼ë¦¬ë¥¼ ë„£ëŠ”ë‹¤.
- ë°”ì¸ë”©í•  íŒŒë¼ë¯¸í„°ê°€ ìˆë‹¤ë©´ ë‘ë²ˆì§¸ íŒŒë¼ë¯¸í„°ì— ì¶”ê°€í•˜ê³ , ì—†ë‹¤ë©´ ìƒëµí•œë‹¤.
- ë§ˆì§€ë§‰ íŒŒë¼ë¯¸í„°ëŠ” RowMapper ì½œë°±ì´ë‹¤.
- query() í…œí”Œë¦¿ì€ SQLì„ ì‹¤í–‰í•´ì„œ ì–»ì€ ResultSetì˜ ëª¨ë“  ë¡œìš°ë¥¼ ì—´ëŒí•˜ë©´ì„œ ë¡œìš°ë§ˆë‹¤ RowMapper ì½œë°±ì„ í˜¸ì¶œí•œë‹¤.

<br/>

> ***í…ŒìŠ¤íŠ¸ ë³´ì™„***

- getAll()ì—ì„œë„ ì˜ˆì™¸ì ì¸ ì¡°ê±´ì— ëŒ€í•œ í…ŒìŠ¤íŠ¸ë¥¼ ë¹¼ë¨¹ì§€ ë§ì•„ì•¼ í•œë‹¤.
- ë³´í†µì€ getAll()ì„ í…ŒìŠ¤íŠ¸ í•  ë•Œ ë ˆì½”ë“œ ëª‡ ê°œë¥¼ ì¶”ê°€í•˜ê³ ì„œ ê·¸ ê²°ê³¼ë§Œ í™•ì¸í•˜ê³  ë§ê¸° ì‰½ë‹¤. (ê¸ì •ì ì¸ ê²°ê³¼ë§Œ í…ŒìŠ¤íŠ¸)
- í˜„ëª…í•œ ê°œë°œìê°€ ë˜ë ¤ë©´ ê·¸ë³´ë‹¤ ì¢€ ë¶€ì •ì ì¸ ìì„¸ê°€ í•„ìš”í•˜ë‹¤.
- ë„¤ê±°í‹°ë¸Œ í…ŒìŠ¤íŠ¸(ì˜ˆì™¸ìƒí™©ì— ëŒ€í•œ í…ŒìŠ¤íŠ¸)ëŠ” í•­ìƒ ë¹¼ë¨¹ê¸° ì‰½ë‹¤.
- get()ì´ë¼ë©´ Idê°€ ì—†ì„ ë•ŒëŠ” ì–´ë–»ê²Œ ë˜ëŠ”ì§€, getAll()ì´ë¼ë©´ ê²°ê³¼ê°€ í•˜ë‚˜ë„ ì—†ëŠ” ê²½ìš°ì—ëŠ” ì–´ë–»ê²Œ ë˜ëŠ”ì§€ë¥¼ ê²€ì¦í•´ì•¼ í•œë‹¤.

<br/>

ğŸ”½ ë°ì´í„°ê°€ ì—†ëŠ” ê²½ìš°ì— ëŒ€í•œ ê²€ì¦ ì½”ë“œê°€ ì¶”ê°€ëœ getAll() í…ŒìŠ¤íŠ¸
```java
public void getAll() {
  dao.deleteAll();

  List<User> users0 = dao.getAll();
  assertThat(users0.size(), is(0)); // ë°ì´í„°ê°€ ì—†ì„ ë•ŒëŠ” í¬ê¸°ê°€ 0ì¸ ë¦¬ìŠ¤íŠ¸ ì˜¤ë¸Œì íŠ¸ ë¦¬í„´
}
```
- getAll()ì— ëŒ€í•œ í…ŒìŠ¤íŠ¸ ì½”ë“œì¸ ë™ì‹œì— getAll()ì˜ ê¸°ëŠ¥ì„ ì„¤ëª…í•´ì£¼ëŠ” ì½”ë“œì´ë‹¤.
- ì˜ˆìƒë˜ëŠ” ê²°ê³¼ë¥¼ ëª¨ë‘ ê²€ì¦í•˜ëŠ” ê²ƒì´ ì˜³ë‹¤.

<br/>

### 3.6.5 ì¬ì‚¬ìš© ê°€ëŠ¥í•œ ì½œë°±ì˜ ë¶„ë¦¬
> ***DIë¥¼ ìœ„í•œ ì½”ë“œ ì •ë¦¬***

ğŸ”½ ë¶ˆí•„ìš”í•œ DataSource ë³€ìˆ˜ë¥¼ ì œê±°í•˜ê³  ë‚¨ì€ UserDaoì˜ DI ì½”ë“œ
```java
private JdbcTemplate jdbcTemplate;

public void setDataSource(DataSource dataSource) {
  this.jdbcTemplate = new JdbcTemplate(dataSource); // DataSource ì˜¤ë¸Œì íŠ¸ëŠ” JdbcTemplateì„ ë§Œë“  í›„ì—ëŠ” ì‚¬ìš©í•˜ì§€ ì•Šìœ¼ë‹ˆ ì €ì¥í•´ë‘ì§€ ì•Šì•„ë„ ëœë‹¤.
}
```
- í•„ìš” ì—†ì–´ì§„ DataSource ì¸ìŠ¤í„´ìŠ¤ ë³€ìˆ˜ëŠ” ì‚­ì œí•œë‹¤.
- UserDaoì˜ ëª¨ë“  ë©”ì†Œë“œê°€ JdbcTemplateì„ ì´ìš©í•˜ë¯€ë¡œ, DataSourceë¥¼ ì§ì ‘ ì‚¬ìš©í•  ì¼ì€ ì—†ë‹¤.
- JdbcTemplateì„ ìƒì„±í•˜ë©´ì„œ ì§ì ‘ DI í•´ì£¼ê¸° ìœ„í•œ DataSourceë¥¼ ì „ë‹¬ë°›ê¸° ìœ„í•´ ìˆ˜ì •ì ë©”ì†Œë“œëŠ” ë‚¨ê²¨ë‘”ë‹¤.

<br/>

> ***ì¤‘ë³µ ì œê±°***

ğŸ”½ ì¬ì‚¬ìš© ê°€ëŠ¥í•˜ë„ë¡ ë…ë¦½ì‹œí‚¨ RowMapper
```java
public class UserDao {
  private RowMapper<User> userMapper = new RowMapper<User>() {
    public User mapRow(ResultSet rs, int rowNum) throws SQLException {
      User user = new User();
      user.setId(rs.getString("id"));
      user.setName(rs.getString("name"));
      user.setPassword(rs.getString("password"));
      return user;
    }
  };
  ...
}
```
- get()ê³¼ getAll()ì—ì„œ ì‚¬ìš©í•œ RowMapperì˜ ë‚´ìš©ì´ ë˜‘ê°™ë‹¤.
- Userìš© RowMapper ì½œë°±ì„ ë©”ì†Œë“œì—ì„œ ë¶„ë¦¬í•´ ì¤‘ë³µì„ ì—†ì• ê³  ì¬ì‚¬ìš© í•  ìˆ˜ ìˆë„ë¡ í•œë‹¤.
- RowMapper ì½œë°± ì˜¤ë¸Œì íŠ¸ì—ëŠ” ìƒíƒœì •ë³´ê°€ ì—†ê¸° ë•Œë¬¸ì—, í•˜ë‚˜ì˜ ì½œë°± ì˜¤ë¸Œì íŠ¸ë¥¼ ë©€í‹°ìŠ¤ë ˆë“œì—ì„œ ë™ì‹œì— ì‚¬ìš©í•´ë„ ëœë‹¤. (í•˜ë‚˜ë¡œ ê³µìœ )
- userMapperë¼ëŠ” ì´ë¦„ìœ¼ë¡œ ì¸ìŠ¤í„´ìŠ¤ ë³€ìˆ˜ë¥¼ ë§Œë“¤ê³  ì‚¬ìš©í•  ë§¤í•‘ìš© ì½œë°± ì˜¤ë¸Œì íŠ¸ë¥¼ ì´ˆê¸°í™”ì‹œí‚¨ë‹¤.

<br/>

ğŸ”½ ê³µìœ  userMapperë¥¼ ì‚¬ìš©í•˜ë„ë¡ ìˆ˜ì •í•œ get(), getAll()
```java
public User get(String id) {
  return this.jdbcTemplate.queryForObject("select * from users where id = ?", new Object[] {id}, this.userMapper);
}

public List<User> getAll() {
  return this.jdbcTemplate.query("select * from users order by id", this.userMapper);
}
```
- ì¸ìŠ¤í„´ìŠ¤ ë³€ìˆ˜ì— ì €ì¥í•´ë‘” userMapper ì½œë°± ì˜¤ë¸Œì íŠ¸ë¥¼ get()ê³¼ getAll()ì—ì„œ ì‚¬ìš©í•œë‹¤.

<br/>

> ***í…œí”Œë¦¿/ì½œë°± íŒ¨í„´ê³¼ UserDao***

ğŸ”½ JdbcTemplateì„ ì ìš©í•œ UserDao í´ë˜ìŠ¤
```java
public class UserDao {
  public void setDataSource(DataSource dataSource) {
    this.jdbcTemplate = new JdbcTemplate(dataSource);
  }

  private JdbcTemplate jdbcTemplate;

  private RowMapper<User> userMapper = new RowMapper<User>() {
    public User mapRow<User>(ResultSet rs, int rowNum) throws SQLException {
      User user = new User();
      user.setId(rs.getString("id"));
      user.setName(rs.getString("name"));
      user.setPassword(rs.getString("password"));
      return user;
    }
  };

  public void add(final User user) {
    this.jdbcTemplate.update("insert into users(id, name, password) values(?,?,?)", user.getId(), user.getName(), user.getPassword());
  }

  public User get(String id) {
    return this.jdbcTemplate.queryForObject("select * from users where id = ?", new Object[] {id}, this.userMapper);
  }

  public void deleteAll() {
    this.jdbcTemplate.update("delete from users");
  }

  public int getCount() {
    return this.jdbcTemplate.queryForInt("select count(*) from users");
  }

  public List<User> getAll() {
    return this.jdbcTemplate.query("select * from users order by id", this.userMapper);
  }
}
```
- ìµœì¢…ì ìœ¼ë¡œ ì™„ì„±ëœ UserDao í´ë˜ìŠ¤
- **í…œí”Œë¦¿/ì½œë°± íŒ¨í„´ê³¼ DI**ë¥¼ ì´ìš©í•¨ìœ¼ë¡œì¨ ì˜ˆì™¸ì²˜ë¦¬ì™€ ë¦¬ì†ŒìŠ¤ ê´€ë¦¬, ìœ ì—°í•œ DataSource í™œìš© ë°©ë²•ê¹Œì§€ ì œê³µí•˜ê³ , ê¹”ë”í•œ ì½”ë“œë¡œ ì •ë¦¬ë˜ì—ˆë‹¤.
- ë§Œì•½ ì‚¬ìš©í•  í…Œì´ë¸”ê³¼ í•„ë“œ ì •ë³´ê°€ ë°”ë€Œë©´ UserDaoì˜ ê±°ì˜ ëª¨ë“  ì½”ë“œê°€ í•¨ê»˜ ë°”ë€ë‹¤. ë”°ë¼ì„œ **ì‘ì§‘ë„ê°€ ë†’ë‹¤.**
- JDBC APIë¥¼ ì‚¬ìš©í•˜ëŠ” ë°©ì‹, ì˜ˆì™¸ì²˜ë¦¬, ë¦¬ì†ŒìŠ¤ì˜ ë°˜ë‚©, DB ì—°ê²°ì„ ì–´ë–»ê²Œ ê°€ì ¸ì˜¬ì§€ì— ê´€í•œ ì±…ì„ê³¼ ê´€ì‹¬ì€ ëª¨ë‘ JdbcTemplateì—ê²Œ ìˆë‹¤.
- ìœ„ì™€ ê°™ì€ ë³€ê²½ì´ ì¼ì–´ë‚œë‹¤ê³  í•´ë„, UserDao ì½”ë“œì—ëŠ” ì•„ë¬´ëŸ° ì˜í–¥ì„ ì£¼ì§€ ì•ŠëŠ”ë‹¤. **ì±…ì„ì´ ë‹¤ë¥¸ ì½”ë“œì™€ ë‚®ì€ ê²°í•©ë„ë¥¼ ìœ ì§€**í•œë‹¤.
- JdbcTemplateì€ ì§ì ‘ ì´ìš©í•˜ê¸° ë•Œë¬¸ì—, **í…œí”Œë¦¿/ì½œë°± êµ¬í˜„ì— ëŒ€í•œ ê°•í•© ê²°í•©**ì„ ê°–ê³  ìˆë‹¤.
- ì‚¬ì‹¤ìƒ í‘œì¤€ ê¸°ìˆ ì´ê³ , JDBC ëŒ€ì‹  ë‹¤ë¥¸ ë°ì´í„° ì•¡ì„¸ìŠ¤ ê¸°ìˆ ì„ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” ì´ìƒ ë°”ë€” ë¦¬ê°€ ì—†ê¸° ë•Œë¬¸ì— ê·¸ëŒ€ë¡œ ë‘¬ë„ ëœë‹¤.
- ë” ë‚®ì€ ê²°í•©ë„ë¥¼ ìœ ì§€í•˜ê³  ì‹¶ë‹¤ë©´ JdbcTemplateì„ ë…ë¦½ì ì¸ ë¹ˆìœ¼ë¡œ ë“±ë¡í•˜ê³  JdbcOperations ì¸í„°í˜ì´ìŠ¤ë¥¼ í†µí•´ DI ë°›ë„ë¡ í•´ë„ ëœë‹¤.

<br/>

UserDaoë¥¼ ê°œì„ í•˜ê¸° ìœ„í•´ 2ê°€ì§€ ì •ë„ ë” ìš•ì‹¬ë‚´ê³  ì‹¶ì€ ë¶€ë¶„ì´ ìˆë‹¤.
- ì¸ìŠ¤í„´ìŠ¤ ë³€ìˆ˜ë¡œ ì„¤ì •ëœ **userMapperë¥¼ UserDao ë¹ˆì˜ DIìš© í”„ë¡œí¼í‹°ë¡œ** ë§Œë“¤ ìˆ˜ ìˆë‹¤.
- DAO ë©”ì†Œë“œì—ì„œ ì‚¬ìš©í•˜ëŠ” **SQL ë¬¸ì¥ì„ ì™¸ë¶€ ë¦¬ì†ŒìŠ¤ì— ë‹´ê³  ì´ë¥¼ ì½ì–´ì™€ ì‚¬ìš©**í•˜ë„ë¡ í•  ìˆ˜ ìˆë‹¤.
