# 7.4 인터페이스 상속을 통한 안전한 기능확장

애플리케이션을 새로 시작하지 않고 특정 SQL의 내용만을 변경하고 싶다면 SqlService 구현 클래스부터 핵심 인터페이스까지 고쳐야 한다. 지금부터는 기존에 설계하고 개발했던 기능이 발전돼야 할 경우에 스프링에서의 접근 방법을 알아볼 곳이다.

## 7.4.1 DI와 기능의 확장

DI는 일종의 디자인 패턴 또는 프로그래밍 모델이라는 관점에서 이해하는 것이 더 자연스럽다. DI의 가치를 얻으려면 먼저 DI에 적합한 오브젝트 설계가 필요하다.

### DI를 의식하는 설계

우리는 하나의 클래스에 때려박지 않고 진행했기에 유연한 방식으로 의존관계를 맺으며 독립적으로 발전했다.

DI덕분이다 DI란 미래를 프로그래밍 하는 것이다.

### DI와 인터페이스 프로그래밍

DI를 DI답게 만들려면 두 개의 오브젝트가 인터페이스를 통해 느슨하게 연결돼야 한다.

클래스가 아닌 인터페이스를 사용하는 이유

1. 다형성을 얻기 위해서이다.
2. 인터페이스 분리 원칙을 통해 클라이언트와 의존 오브젝트 사이의 관계를 명확하게 해줄 수 있기 때문이다.

오브젝트가 그 자체로 충분히 응집도가 높은 작은 단위로 설계됐더라도, 목적과 관심이 각기 다른 클라이언트가 있다면 인터페이스를 통해 이를 적절하게 분리해줄 필요가 있고 이를 인터페이스 분리 원칙이라고 한다.

→ 즉 DI는 반드시 인터페이스를 써야한다고 합니다.

## 7.4.2 인터페이스 상속

하나의 오브젝트가 구현하는 인터페이스를 여러 개 만들어서 구분하는 이유 중의 하나는 오브젝트의 기능이 발전하는 과정에서 다른 종류의 클라이언트가 등장하기 때문이다.

인터페이스 분리 원칙이 주는 장점

→ 모든 클라이언트가 자신의 관심에 따른 접근 방식을 불필요한 간섭 없이 유지할 수 있다는 점이다.

SqlService의 기본 구현인 BaseSqlService 클래스의 설계 구조

![image](https://github.com/Team-Sopetit/server-spring-study/assets/80771842/69f33ffa-7d1a-4d92-8967-60f8b6a7ea67)

인터페이스를 사용해 만들었기 때문에 제 3의 클라이언트를 위한 인터페이스를 가질 수 있다.

SqlRegistry 인터페이스

![image](https://github.com/Team-Sopetit/server-spring-study/assets/80771842/8dffeeeb-3347-445b-b410-04f349f627a6)

여기에 SQL을 변경할 수 있는 기능을 넣어서 확장할 것이다.

이때도 새로운 인터페이스를 정의하거나 기존 인터페이스를 확장해야 한다.

새로운 클라이언트가 필요로 하는 인터페이스는 SQL에 대한 수정을 요청할 수 있는 메소드를 갖고 있어야 한다.

기존의 SqlRegistry 인터페이스를 상속하고 메소드를 추가해서 새로운 인터페이스로 정의한다.

![image](https://github.com/Team-Sopetit/server-spring-study/assets/80771842/fcaaaf31-ff1b-4cd0-89d9-84d67f5f5c56)

SQL 업데이트 기능까지 구현한 SQL 레지스트리 클래스를 MyUpdatableSqlRegistry라고 하면 그림과 같은 의존관계가 만들어진다.

![image](https://github.com/Team-Sopetit/server-spring-study/assets/80771842/7d667166-39de-4cdf-ac6f-374b21aa3126)

![image](https://github.com/Team-Sopetit/server-spring-study/assets/80771842/798df8af-348b-492c-becd-5d1b780c8c8c)

위 코드를 보면 BaseSqlService와 SqlAdminService는 동일한 오브젝트에 의존하고 있지만 각자의 관심과 필요에 따라서 다른 인터페이스를 통해 접근한다.

결론은 인터페이스를 적절하게 분리하고 확장하는 방법을 통해 오브젝트 사이의 의존관계를 명확하게 해주고, 기존 의존관계에 영향을 주지 않으면서 유연한 확장성을 얻는 방법이 무엇인지 항상 고민해야 한다.

625페이지부터

# 7.5 DI를 이용해 다양한 구현 방법 적용하기
